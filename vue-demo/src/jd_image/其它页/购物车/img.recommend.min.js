(function(a){a.fn.imglazyLoad=function(c){return new b(c)};var b=(function(){var c=function(d){this.duration=d.duration?d.duration:this.duration;this.container=d.container?d.container:this.container;this._src=d._src?d._src:this._src;this.rangeH=d.rangeH?d.rangeH:this.rangeH;this.animationName=d.animationName?d.animationName:this.animationName;this.showDelay=d.showDelay?d.showDelay:this.showDelay;this.styleContianer=d.styleContianer?d.styleContianer:this.styleContianer;this.scrollObj=d.scrollObj||this.scrollObj;this.init()};c.prototype={scrollObj:window,refreshTimer:null,duration:100,_src:"_src",container:"",rangeH:0,animationName:"fade",showDelay:"200",styleContianer:"styleID",belowthefold:function(f){var e=a(window).scrollTop();var d=this.rangeH;var h=a(f).offset().top;var g=a(f).get(0).offsetHeight+2;return(e-d)<=(h+g)},abovethetop:function(f){var e=a(f).offset().top,d=a(window).scrollTop(),h=document.documentElement.clientHeight,g=this.rangeH;return e<=(d+h+g)},inViewport:function(g){var f=this.belowthefold(g);var d=this.abovethetop(g);var e=f&&d;return e},setStyle:function(f,e){for(var d in e){f.style[d]=e[d]}},checkIphone:function(){var d=window.navigator.userAgent.toLowerCase();if(/iphone|ipd|ipod/.test(d)){return true}else{return false}},addStyle:function(){var d=document.getElementById(this.styleContianer)||document.getElementsByTagName("head")[0];var e=document.createElement("style");e.innerHTML+=" @-webkit-keyframes fade { 0%   { opacity: 0; } 100%   { opacity: 1; }} @keyframes fade {  0%   { opacity: 0; }  100%   { opacity: 1; }}";d.appendChild(e)},loading:function(){var e=this;var f=[];var d=document.getElementById(e.container);if(d){f=a(d).find("img["+e._src+"]")}else{f=a("img["+e._src+"]")}f.each(function(h){var g=f.eq(h);if(e.inViewport(g)&&typeof(g.attr("_src"))!="undefined"){e.changSrc(g)}})},setImgURL:function(f){var e=this;var h=f.attr(""+e._src+"");var d=parseInt(f.width())*2;var g=parseInt(f.height())*2;h=h.replace(/(s[0-9]{0,4}x[0-9]{0,4}_)?jfs/,"s"+d+"x"+g+"_jfs");if(h.indexOf(".webp")==-1&&!e.checkIphone()){h=h+".webp"}return h},changSrc:function(e){var d=this;var h=e.attr(""+d._src+"");var g=new Image();var f=d.setImgURL(e);e.css("opacity",0);g.src=f;g.onload=function(){e.attr("src",f).removeAttr(""+d._src+"");e.css("opacity",1)};g.onerror=function(){e.attr("src",h).removeAttr(""+d._src+"");e.css("opacity",1)}},init:function(){var d=this;setTimeout(function(){d.loading()},300);a(this.scrollObj).bind("scroll",function(){if(d.refreshTimer){clearTimeout(d.refreshTimer);d.refreshTimer=null}d.refreshTimer=setTimeout(function(){d.loading()},d.duration)})}};return c})();a.loadImg={lazyLoad:function(c){return a(document.body).imglazyLoad(c)}}})($);function gosimilar(b){var a="https://home.m.jd.com/myjd/similar/list.action?skuId="+b+"&sid="+document.getElementById("sid").value;try{pingClick(cartUse,"MShopcart_EmptySimilar",b,"","","3")}catch(c){}setTimeout(function(){window.location.href=a},100)}function Recommend(a){this.containerID=a.containerID;this.url=a.url;this.maxCount=a.maxCount;this.everyPage=a.everyPage;this.pageCount=a.pageCount;this.callBack=a.callBack||null;this.noMore=document.getElementsByClassName("no-more")[0];this.pageNum=1;this.itemDiv="";this.containers=document.getElementById(this.containerID);this.clientWidth=document.documentElement.clientWidth||document.body.clientWidth;this.imgWidth=(this.clientWidth-4)/2-8+"px";this.loadList();this.bindScrollEvts();this.isRepeatReq=true;this.bindorientationchange();this.windowResize()}function refreshCartHtml(){pingClick(cartUse,"MShopcart_Refresh","","","");window.location.reload()}function recommendAddCartin(a){$(".refresh-cart-prompt").hide();setTimeout(function(){var c=$("#sid").val();var b="/cart/add.json?wareId="+a+"&sid="+c;jQuery.get(b,{},function(d){if(d.cart&&d.cart.Num&&d.cart.Num>0){$(".refresh-cart-prompt").html("<span>\u52a0\u8f66\u6210\u529f\uff01</span><span><i></i>\u70b9\u51fb\u67e5\u770b\u65b0\u52a0\u5165\u5546\u54c1</span>")}else{if(d.cart.resultMsg||d.cart.resultMsg!=undefined||d.cart.resultMsg!=null){$(".refresh-cart-prompt").html("<span>\u52a0\u8f66\u5931\u8d25\uff01</span><span>"+d.resultMsg+"</span>")}else{$(".refresh-cart-prompt").html("<span>\u52a0\u8f66\u5931\u8d25\uff01</span>")}}$(".refresh-cart-prompt").fadeIn();pingClick(cartUse,"MShopcart_RecAddToCart",a,"","","5");setTimeout(function(){$(".refresh-cart-prompt").fadeOut()},10000)})},400)}Recommend.prototype={bindScrollEvts:function(){var a=this;window.addEventListener("scroll",function(){var b=document.documentElement.clientHeight||document.body.clientHeight;var d=document.documentElement.scrollTop||document.body.scrollTop;var c=document.documentElement.scrollHeight||document.body.scrollHeight;if((b+d+600)>=c&&a.pageNum<=(a.pageCount-1)){a.pageNum++;a.loadList();a.isRepeatReq=true}return false})},bindorientationchange:function(){var d=this;var a=document.getElementsByClassName("Jschangewidth");var c="onorientationchange" in window;var b=c?"orientationchange":"resize";window.addEventListener(b,function(){setTimeout(function(){d.clientWidth=document.documentElement.clientWidth||document.body.clientWidth;d.imgWidth=(d.clientWidth-4)/2+"px";for(var e=0;e<a.length;e++){a[e].setAttribute("height",d.imgWidth);a[e].setAttribute("width",d.imgWidth)}},300)})},goBack2Top:function(){var c=document.querySelector("#indexToTop");var b="click";var a={init:function(){a.scrollEvt();a.toTopEvt()},toTopEvt:function(){c.addEventListener(b,function(){scroll(0,0);c.style.display="none"},false)},scrollEvt:function(){window.addEventListener("scroll",function(){var d=document.documentElement.clientHeight||document.body.clientHeight;var e=document.documentElement.scrollTop||document.body.scrollTop;if(e>d*2){c.style.display="block"}else{c.style.display="none"}},false)}};return a.init()},addHtml:function(d,a,e){if(e){this.itemDiv+='<li class="similar-li"><a href="'+d.clickUrl+'">';this.itemDiv+='<div class="recommend-config-infor">';this.itemDiv+='<img class="recommend-config-infor-img" src="'+d.imageurl+'">';this.itemDiv+="</div></a></li>"}else{if(this.containerID=="recommendID"){this.itemDiv+='<li class="similar-li"><a href="javascript:beWareDetailNotEmpty('+d.wareId+",'"+d.sourceValue+"','"+d.clickUrl+"');\">"}else{this.itemDiv+='<li class="similar-li"><a href="javascript:beWareDetailEmpty('+d.wareId+","+((this.pageNum-1)*this.everyPage+a)+",'"+d.clickUrl+"');\">"}this.itemDiv+='<div class="similar-product" ><div class="similar-nimg"><img class="Jschangewidth" _src="';if(d.imageurl){this.itemDiv+=d.imageurl.replace("http:","")}else{this.itemDiv+=d.imageurl}this.itemDiv+='" height="'+this.imgWidth+'" width="'+this.imgWidth+'">';if(d.recomText||d.recomText!=undefined||d.recomText!=null){this.itemDiv+='<span class="recommend-reason-txt">'+d.recomText+"</span></div>"}this.itemDiv+='<span class="similar-product-text">';if(d.wareType==8){this.itemDiv+='<img src="'+d.markImageUrl+'" class="chosen" width="'+d.markWidth+'" height="'+d.markHeight+'">'}else{if(d.isSamWare){this.itemDiv+='<img src="/images/sam/samsb.png" class="samsb">'}}this.itemDiv+=d.wname;this.itemDiv+='</span><span class="similar-product-price">&yen;<span class="big-price">';this.itemDiv+=d.jdPrice;this.itemDiv+='</span><span class="small-price"></span>';if(d.isSamWare){this.itemDiv+='<span class="sam-price">&yen;'+d.samPrice+"</span>"}else{if(d.isPlusWare){var b;if(d.plusPrice!=undefined){b=d.plusPrice}else{if(d.tryPlusPrice!=undefined){b=d.tryPlusPrice}}this.itemDiv+='<span class="sam-price  plus-price">&yen;'+b+"</span>"}else{var c="";if(d.commentCount==10000){c="1\u4e07"}else{if(d.commentCount>10000){c=Math.round((d.commentCount/10000)*10)/10+"\u4e07"}else{c=d.commentCount}}this.itemDiv+='<span class="recomm-comment-num">'+c+"\u6761\u8bc4\u8bba</span>"}}this.itemDiv+="</span>";this.itemDiv+='<span class="guess-button recommend-add-cart" onclick="(function(){event.preventDefault();event.stopPropagation();recommendAddCartin('+d.wareId+');})()"></span>';if(this.containerID=="emptyRecommendID"){this.itemDiv+='<span class="guess-button" onclick="(function(){event.preventDefault();event.stopPropagation();gosimilar('+d.wareId+');})()">\u770b\u76f8\u4f3c</span>'}this.itemDiv+='<div style="clear:both"></div>';this.itemDiv+='<span class="sam-space"></span>';this.itemDiv+="</div></a></li>"}},irregularPrice:function(c,b){var f=document.getElementsByClassName(c);var e=document.getElementsByClassName(b);for(var d=0;d<f.length;d++){var a=f[d].innerHTML.split(".");f[d].innerHTML=a[0];e[d].innerHTML="."+a[1]}},drawList:function(c){var a;var d=false;if(this.maxCount<=c.length){a=this.maxCount;for(var b=0;b<a;b++){if(c[b].wareId==""||c[b].wareId==null||c[b].wareId==undefined){d=true}else{d=false}this.addHtml(c[b],b,d)}}else{a=c.length;for(var b=0;b<a;b++){if(c[b].wareId==""||c[b].wareId==null||c[b].wareId==undefined){d=true}else{d=false}this.addHtml(c[b],b,d)}}this.containers.innerHTML=this.itemDiv;this.irregularPrice("big-price","small-price")},loadList:function(){var a=this;$.ajax({type:"get",url:this.url+"&recommendPage="+this.pageNum+"&recommendPageSize="+this.everyPage,dataType:"json",beforeSend:function(){},success:function(b){if(!!b&&!!b.guessYouLikeJson&&!!b.guessYouLikeJson.wareInfoList&&b.guessYouLikeJson.wareInfoList.length!=0){a.showModuleFn();a.drawList(b.guessYouLikeJson.wareInfoList);a.setSamProductHeight(0);a.callBack&&a.callBack()}else{a.hideModuleFn()}},error:function(d,c,b){a.hideModuleFn()}})},hideModuleFn:function(){var a=this;if(a.pageNum==1){if(a.containerID=="emptyRecommendID"){document.querySelector("#emptycartHotRecommend").style.display="none"}if(a.containerID=="recommendID"){document.querySelector("#notEmptyRecommend").style.display="none"}}},showModuleFn:function(){var a=this;if(a.containerID=="emptyRecommendID"){document.querySelector("#emptycartHotRecommend").style.display="block"}if(a.containerID=="recommendID"){document.querySelector("#notEmptyRecommend").style.display="block"}},setSamProductHeight:function(f){var j=$(".similar-li"),a=null,k=null,h=null,g=null,d=null,c=null;var b=f;f=j.length/2;for(var e=b;e<f;e++){$(j[e*2]).height(parseInt($(j[e*2]).outerHeight()));$(j[e*2+1]).height(parseInt($(j[e*2+1]).outerHeight()));if($(j[e*2]).find(".recommend-config-infor").length>0){$(j[e*2]).height($(j[e*2+1]).outerHeight())}else{if($(j[e*2+1]).find(".recommend-config-infor").length>0){$(j[e*2+1]).height($(j[e*2]).outerHeight())}else{a=$(j[e*2]).find(".guess-button");k=$(j[e*2+1]).find(".guess-button");h=$(j[e*2]).find(".recommend-add-cart");g=$(j[e*2+1]).find(".recommend-add-cart");d=$(j[e*2]).find(".sam-space");c=$(j[e*2+1]).find(".sam-space");if(a.length>0&&h.length>0&&k.length==0&&g.length==0&&c.hasClass(".sam-height")=="false"){c.addClass("sam-height");$(j[e*2+1]).height(parseInt($(j[e*2+1]).outerHeight())+$(".sam-height").height())}else{if(a.length==0&&h.length==0&&k.length>0&&g.length>0&&d.hasClass(".sam-height")=="false"){d.addClass("sam-height");$(j[e*2]).height(parseInt($(j[e*2]).outerHeight())+$(".sam-height").height())}}}}}},windowResize:function(){var c=this;var b="onorientationchange" in window;var a=b?"orientationchange":"resize";window.addEventListener(a,function(){setTimeout(function(){$(".similar-li").css("height","auto");c.setSamProductHeight(0)},350)})}};var beWareDetailEmpty=function(c,e,d){if(d!=""){jQuery.get(d,{},function(){})}var a="https://item.m.jd.com/product/"+c+".html";var b=c+"_"+e;pingClick(cartUse,"MShopcartsale_HotSale",b,"","","4");setTimeout(function(){window.location.href=a},200)};var beWareDetailNotEmpty=function(c,e,d){if(d!=""){jQuery.get(d,{},function(){})}var a="https://item.m.jd.com/product/"+c+".html";var b=getEventPara(e);b=b+"_"+a;pingClick(cartUse,"MShopcart_GuessYouLike",b,"","");setTimeout(function(){window.location.href=a},200)};var getEventPara=function(c){var a=new Array();a=c.split("_");var b="";b+=a[1];b=b+"_"+a[0];b=b+"_"+a[5];b=b+"_"+a[7];b=b+"_"+a[6];return b};
