$(".cart-product-cell-3").each(function(){var c=$(this).width();var b=$(this).find(".shp-cart-item-price").width();var a=$(this).find(".quantity-wrapper").width();if((c-b-a)<32){$(this).find(".members-plus-icon").hide();$(this).find(".shp-cart-item-price").removeClass(".membersPrice")}});var spiner=createSpinner();var background=document.getElementById("background");var spinerShow=function(){background.style.display="block";spiner.spin(background);var a=parseInt(document.documentElement.clientHeight/2);$("#background > div").css({position:"fixed",top:a})};var spinerHide=function(){background.style.display="none";spiner.stop()};var addCartWare=function(h,d,g,c,f,e,b){var a="/cart/add.json?wareId="+h+"&num="+d+"&sid="+$("#sid").val();a=appendSuit(a,g,c,f,e,b);spinerShow();jQuery.get(a,{},function(i){checkInterface(i);calcCartCheck(i,h);calcCartGifts(i,h);checkFreightEntrance(i);commonCheck(i);if(e!=null&&e!=""){calcCartYanBao(i,h,c)}},"json")};var addCartWareDirect=function(h,d,g,c,f,e,b){var a="/cart/add.json?wareId="+h+"&num="+d+"&sid="+$("#sid").val();a=appendSuit(a,g,c,f,e,b);jQuery.get(a)};var modifyWare=function(i,b,e,a,l,c,m,d){var f;if((!isBlank(a)&&a!=4)){f=l}else{f=b}var h=$("#num"+f).val();var k=parseInt($("#limitSukNum"+f).val());var j=parseInt($("#remainNumInt"+f).val());if(!/^\d+$/.test(h)){alert("\u4fee\u6539\u6570\u91cf\u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5");$("#num"+f).val(1);h=1}if(Number(h)>k){alert("\u4fee\u6539\u6570\u91cf\u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5");$("#num"+f).val(k);h=k}if(Number(h)>j&&j>=0){$("#num"+f).val(j);h=j}if(Number(h)<1){alert("\u4fee\u6539\u6570\u91cf\u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5");$("#num"+f).val(1);h=1}if(h==1){$("#subnum"+f).addClass("disabled")}if(h<k){$("#addnum"+f).removeClass("disabled")}if(h>=j&&j>=0){$("#addnum"+f).addClass("disabled")}if(h<j){$("#addnum"+f).removeClass("disabled")}if(h>1){$("#subnum"+f).removeClass("disabled")}if(h==k){$("#addnum"+f).addClass("disabled")}$("#numerror"+b).text("");if(isBlank(e)||(!isBlank(a)&&a==4)){e=$("#num"+b).val()}else{c=$("#num"+l).val()}var g="/cart/modify.json?wareId="+b+"&num="+e+"&sid="+$("#sid").val();g=appendSuit(g,a,l,c,m,d);spinerShow();jQuery.get(g,{},function(n){checkInterface(n);calcCartCheck(n,f,i,true);calcCartGifts(n,b);calcCartPrice(n,f);checkFreightEntrance(n);commonCheck(n);$("span[name='suitSkuNum"+b+"']").text(h);setDefiniteNumById(n,f);judgeLeastNumState(f);pingClick(cartUse,"MShopcart_Amount",f,"modifyWare","http://p.m.jd.com/cart/modify.action")},"json")};var operateDele=function(g,h,b,d,i,c,a,j,f){var e="/cart/remove.json?wareId="+b+"&num="+d+"&sid="+$("#sid").val();e=appendSuit(e,a,i,c,j);spinerShow();jQuery.get(e,{},function(n){checkInterface(n);calcCartCheck(n,b);calcCartGifts(n,b);checkFreightEntrance(n);commonCheck(n);checkSelfCouponEntrance(n);var o=i;if(f!="gift"){if(!a||a==4){$("#checkIcon"+b).removeAttr("data-sku");o=b;var r=$("#product"+b);r.hide();r.attr("name","remove"+r.name);calcCartShop(g,h);var m=$("#solidLine"+b);m.hide()}else{var p=document.getElementsByName("item"+b);var l=p.length;if(l==1){var r=$("#product"+b);r.hide();r.attr("name","remove"+r.name);var m=$("#solidLine"+b);m.hide();calcCartShop(g,h)}else{$("#product"+i).hide();hideProductInfo("#product"+i);$("#hr"+i).hide();if(p[l-1].id=="product"+i){$("#hr"+p[l-2].id.substring(7)).hide()}$("#product"+i).attr("name","deleteitem"+b)}$("#checkIcon"+i).removeAttr("data-sku")}}if(n.cart.isShowMessage&&n.cart.skuLabelIdList!=""){priceReTxt=n.cart.notice.text;var k=n.cart.noticeNextMessage;if(k!=undefined&&k!=""){$("#noticeNextMessage").val(k)}var s=n.cart.noticeType;if(s!=undefined&&s!=""){$("#noticeType").val(s)}if($("#priceReduction").hasClass("check")&&k!=undefined&&k!=""){$("#priceReduction").find(".price-reduct-text").text(k)}else{$("#priceReduction").find(".price-reduct-text").text(priceReTxt)}skuLabelNum=0;$("#skuLabelIdList").attr("value",n.cart.skuLabelIdList)}else{if(!n.cart.isShowMessage&&n.cart.skuLabelsNum==0){priceReId.remove()}}var q=setTimeout(function(){jQuery.loadImg.lazyLoad({rangeH:document.documentElement.clientHeight});clearTimeout(q)},100);pingClick(cartUse,"MShopcartDeleteProduct_Sure",o,"deleteWare","")},"json")};var deleteWare=function(d,h,i,b,e,a,j,c,k,g){pingClick(cartUse,"MShopcart_Delete","","deleteWare","");var f=$(d).find(".wastebin-up");if(!f.hasClass("wastebin-up-animi")){f.removeClass("wastebin-down-animi");f.addClass("wastebin-up-animi");$(d).removeClass("westebin-rock-animi")}popMessage({callback:function(l){if(f.hasClass("wastebin-up-animi")){if(l){$(d).addClass("westebin-rock-animi")}f.removeClass("wastebin-up-animi");f.addClass("wastebin-down-animi")}if(l){operateDele(h,i,b,e,j,c,a,k,g)}else{pingClick(cartUse,"MShopcartDeleteProduct_Cancel","","deleteWare","")}},description:"\u786e\u8ba4\u8981\u5220\u9664\u6b64\u5546\u54c1\u5417\uff1f"})};function hideProductInfo(c){var f=[],e=null;var b=document.querySelector(c);e=b.nextElementSibling||b.nextSibling;while((e&&$(e).has(".shp-cart-gift-list").length!=0)||(e.className&&e.className.indexOf("extended-warranty-area")!=-1)){f.push(e);b=e;e=b.nextElementSibling||b.nextSibling}for(var d=0,a=f.length;d<a;d++){f[d].style.display="none"}}var deleteWareDirect=function(h,c,g,b,f,e,d){var a="/cart/remove.json?wareId="+h+"&num="+c+"&sid="+$("#sid").val();a=appendSuit(a,g,b,f,e);jQuery.get(a)};var directDeleteWare=function(g,b,d,a,h,c,i,f){var e="/cart/remove.json?wareId="+b+"&num="+d+"&sid="+$("#sid").val();e=appendSuit(e,a,h,c,i);jQuery.get(e,{},function(l){var k=$("#sid").val();var j="/cart/cart.action?sid="+k;window.location.href=j},"json")};var showChooseGifts=function(c,b,e,a,g,j,d){if($("#notGivenGift"+b).hasClass("disabled-act-btn")){return false}var f="/cart/getCartSelectGifts.action?sid="+$("#sid").val()+"&promotionId="+b;jQuery.get(f,function(k){if(k!=null){krystal.layerBottom.init({html:k,minRatio:1/3,maxRatio:2/3,closeEle:".additioncl-close",closeFn:null,extraSpace:135,scrollElement:".additional-list-items"});$(".shp-cart-item-price").each(function(){var p=$.trim($(this).text());var l,m,o,n;l=/^.*(\D)(\d*)(\.\d{2})\d*\D*$/;m=p.replace(l,"$1");o=p.replace(l,"$2");n=p.replace(l,"$3");$(this).html(m+"<strong>"+o+"</strong>"+n)})}});if(cartUse){var i;var h;if(Number(d)>0){i="jiajiagou";h="MShopcart_Premium"}else{i="manzeng";h="MShopcart_CouponGift"}pingClick(cartUse,"MShopcart_Getresent",i,"showChooseGifts","");pingClick(cartUse,h,g,"","");if($("#notGivenGiftMsg"+b).html().trim()=="\u67e5\u770b\u8d60\u54c1"){h="MShopcart_CheckPresent";pingClick(cartUse,h,g,"","")}if($("#notGivenGiftMsg"+b).html().trim()=="\u67e5\u770b\u6362\u8d2d"){h="MShopcart_CheckTrade";pingClick(cartUse,h,g,"","")}}};var appendant=function(l){var f,c,j,e,i,h=0;var g=false;if($(".additional-distinguish").length>0){g=true}function b(){$(".shp-cart-list .cart-checkbox").show();$(".shp-cart-icon-remove").css("display","inline-block");$(".shp-cart-list .cart-product-cell-1").css("visibility","visible");$("#mask").css({visibility:"hidden"});$("#mask-con").css({top:"1px"});$("body").css({"padding-bottom":50,width:"100%",height:"auto",overflow:"auto"});$(".shp-cart-list").css({height:"auto"}).removeClass(".crop-list").show();window.scrollTo(0,i)}function k(){if($("#mask-click-hidden").length==0){$("#mask").prepend('<div class="mask-click-hidden" id="mask-click-hidden"></div>')}i=document.body.scrollTop;c=document.documentElement.clientHeight;f=document.documentElement.clientWidth;if(!l||!l.maskType||l.maskType!="skuSwitch"){j=$("#mask .additional-list-container").height()+15;if(g){e=(parseInt(c*0.5)>j)?j:parseInt(c*0.5)}else{e=(parseInt(c*0.6)>j)?j:parseInt(c*0.6)}if($(".additional-item-title").length>0){e+=$(".additional-item-title").height()}}window.addEventListener("orientationchange",d)}function a(){$("#mask").css({visibility:"visible"});k();$("body").css({overflow:"hidden"});if(!l||!l.maskType||l.maskType!="skuSwitch"){if(g){h=-(e+130)}else{h=-(e+42)}setTimeout(function(){$("#mask .additional-list-wrapper").css({height:e,overflow:"auto"});$("#mask-con").css({top:h})},100)}$("#mask-click-hidden").unbind("click");if(g){var m=document.querySelector(".additioncl-close");m.addEventListener("click",function(){b()},false)}$("#mask-click-hidden").bind("click",function(p){b();if(l&&l.maskType&&l.maskType=="skuSwitch"){document.getElementById("mask-con").innerHTML=""}else{if(l!=null){document.getElementById(l.ID).innerHTML=document.getElementById("mask-con").innerHTML;document.getElementById("mask-con").innerHTML="";var o=document.querySelectorAll(".wastebin");for(var n=0;n<o.length;n++){$(o[n]).find(".wastebin-up").removeClass("wastebin-down-animi");$(o[n]).removeClass("westebin-rock-animi")}}}});$("#mask .btn-jd-red").bind("click",function(n){b()})}function d(){if($("#mask").css("visibility")=="hidden"){return}var m=0;switch(window.orientation){case -90:case 90:setTimeout(function(){a()},300);break;default:setTimeout(function(){a()},300);break}return m}a();return{retractMask:function(){b()}}};function resizePriseFontSize(){}function unifyHeight(c,a){var b=c.find(".operating-floor-txt span.second");b.each(function(d){if($(this).height()>a){a=$(this).height()}});b.height(a)}var showGifts=function(b){var a="/cart/cart.json?sid="+$("#sid").val();spinerShow();jQuery.get(a,{},function(c){checkInterface(c);calcCartGifts(c,b);checkFreightEntrance(c);commonCheck(c)},"json")};var hideChooseGifts=function(a,f){var l=$("#giftType").val();var j=$("span[name=gift"+a+"]");if(j.size()>0){var b="";var e="";var c=false;j.each(function(){if($(this).hasClass("checked")){var i=$(this).attr("data-gift");if(b==""){b=i}else{b=b+"@@@"+i}}if($(this).hasClass("newSelect")){$(this).removeClass("newSelect");c=true}if($(this).hasClass("newCancel")){c=true;$(this).removeClass("newCancel");var i=$(this).attr("data-gift");if(e==""){e=i}else{e=e+"@@@"+i}}});var k;if(c){if(b==""){k="/cart/removeWares.json?wareInfos="+e+"&sid="+$("#sid").val()}else{k="/cart/addWares.json?wareInfos="+b+"&sid="+$("#sid").val()}spinerShow();jQuery.get(k,{},function(i){checkInterface(i);calcCartGifts(i,a);checkFreightEntrance(i);commonCheck(i)},"json")}}if(f){krystal.layerBottom.closeBox(false)}else{document.getElementById("mask").style.visibility="hidden";document.getElementById("mask-con").innerHTML=""}if(cartUse){var m="MShopcart_Giftpayment_Sure";if(Number($("#hidegiftSelectType"+a).val())>0){var m="MShopcart_Premium_Sure"}var g=document.getElementsByName("gift"+a);for(var d=0;d<g.length;d++){var j=g[d];if($(j).hasClass("checked")){var h=$("#giftId"+j.id).val();pingClick(cartUse,m,"","","")}}if(l==1||l==2){pingClick(cartUse,"MShopcart_TradeConfirm","","","")}else{if(l==3||l==4){pingClick(cartUse,"MShopcart_GiftConfirm","","","")}}}};var showChooseYanBao=function(b,g,e,f,d,c){if(b=="0"){var a="/cart/check.json?wareId="+g+"&num="+$("#num"+g).val()+"&checked=5&sid="+$("#sid").val();a=appendSuit(a,f,d,c);spinerShow();jQuery.get(a,{},function(h){checkInterface(h);calcCartCheck(h,g);checkFreightEntrance(h);commonCheck(h);document.getElementById("mask-con").innerHTML=document.getElementById("chooseYanbao"+g+d).innerHTML;document.getElementById("mask-con").style.top=(document.documentElement.scrollTop||document.body.scrollTop)+10+"px"},"json")}else{document.getElementById("mask-con").innerHTML=document.getElementById("chooseYanbao"+g+d).innerHTML;document.getElementById("chooseYanbao"+g+d).innerHTML="";appendant({ID:"chooseYanbao"+g+d});pingClick(cartUse,"MShopcart_Warranty",d,"showChooseYanBao","http://p.m.jd.com/cart/cart.action")}};var hideChooseYanBao=function(b,a){document.getElementById("mask").style.visibility="hidden";document.getElementById("chooseYanbao"+b+a).innerHTML=document.getElementById("mask-con").innerHTML;document.getElementById("mask-con").innerHTML=""};var selectGifts=function(b,e,a,c,h,j){var d=0;var f=$("#"+b+c);var i=$("#giftType").val();if(i==2){pingClick(cartUse,"MShopcart_TradeCheckBox",c,"","")}else{if(i==4){pingClick(cartUse,"MShopcart_GiftCheckBox","","","")}}if(f.hasClass("checked")){d=Number($("#hidegiftSelectNum"+b).val())-Number(h);$("#hidegiftSelectNum"+b).val(d);$("#giftSelectNum"+b).html(d);f.removeClass("checked");if(f.hasClass("newSelect")){f.removeClass("newSelect")}else{f.addClass("newCancel")}}else{d=Number($("#hidegiftSelectNum"+b).val())+Number(h);if(j==1){if($("#hidegiftSelectNum"+b).val()==0){$("#hidegiftSelectNum"+b).val(d);$("#giftSelectNum"+b).html(d)}else{$("#hidegiftSelectNum"+b).val(d-1);$("#giftSelectNum"+b).html(d-1)}$(".additional-check-wrapper .cart-checkbox").removeClass("checked");f.addClass("checked");if(f.hasClass("newCancel")){f.removeClass("newCancel")}else{f.addClass("newSelect")}return}else{if(d>j){var g=$.trim($(".additional-choose-num").text());var k=g.substr(1,2);toaster("\u6700\u591a\u53ea\u80fd"+k+j+"\u4ef6\u54e6!","",true);return}}$("#hidegiftSelectNum"+b).val(d);$("#giftSelectNum"+b).html(d);f.addClass("checked");if(f.hasClass("newCancel")){f.removeClass("newCancel")}else{f.addClass("newSelect")}}};var deleteGifts=function(f,d,b,g,e,h,c,a){deleteWare(f,d,b,g,e,h,c,a,"","gift")};var deleteYanBao=function(g,f,h,c,b,e,d){var a="/cart/removeYB.json?wareId="+g+"&num="+f+"&sid="+$("#sid").val();a=appendSuit(a,h,c,b,e,d);jQuery.get(a,{},function(i){checkInterface(i);checkFreightEntrance(i);commonCheck(i)},"json")};var keydown=function(a){$("#"+a).addClass("checked")};var changeSelected=function(h,b,c,a,f,i){var g=6;var e=b;if(a==undefined||a==4){e=b}else{e=f}if($("#checkIcon"+e).hasClass("checked")){$("#checkIcon"+e).removeClass("checked")}else{$("#checkIcon"+e).addClass("checked");g=5}var d="/cart/check.json?wareId="+b+"&num="+c+"&checked="+g+"&sid="+$("#sid").val();d=appendSuit(d,a,f,i);spinerShow();jQuery.get(d,{},function(j){if(j!=undefined){checkInterface(j);calcCartCheck(j,b,h);calcCartGifts(j,b);checkFreightEntrance(j);commonCheck(j);spinerHide();if(g==5){pingClick(cartUse,"MShopcart_CheckProd",e,"","")}}else{if($("#checkIcon"+b).hasClass("checked")){$("#checkIcon"+b).removeClass("checked")}else{$("#checkIcon"+b).addClass("checked")}}},"json")};var calcCartCheck=function(g,p,n,s){try{if(!isBlank(g.cart)&&!!g.cart.vendors){g=g.cart;document.getElementById("cart_oriPrice").innerHTML=g.Price.toFixed(2);document.getElementById("cart_rePrice").innerHTML=g.RePrice.toFixed(2);document.getElementById("cart_realPrice").innerHTML=g.PriceShow;shopCart._setStrAutoWidth("#shpCartTotal",0);shopCart._setStrAutoWidth("#saleOffNew",2);var l;if(g.checkedWareNum>99){l="99+"}else{l=g.checkedWareNum}document.getElementById("checkedNum").innerHTML="\u0028"+l+"\u0029";if(p==-2){var r=g.vendors;var w;var m;var c;var f;var o;var d;for(var u=0;u<r.length;u++){if(r[u].sorted[0].item.CheckType==1){$("#checkShop"+r[u].vendorId).addClass("checked")}else{$("#checkShop"+r[u].vendorId).removeClass("checked")}m=r[u].sorted;for(var t=0;t<m.length;t++){c=m[t];f=c.item.Id;if(c.itemType==1||c.itemType==4){if(c.item.CheckType==1){$("#checkIcon"+f).addClass("checked")}else{$("#checkIcon"+f).removeClass("checked")}}else{skus=c.item.Skus;for(var q=0;q<skus.length;q++){var o=skus[q];if(o.CheckType==1){$("#checkIcon"+o.Id).addClass("checked")}else{$("#checkIcon"+o.Id).removeClass("checked")}}}}}}if(s&&(!$("#checkIcon"+p).hasClass("checked"))){$("#checkIcon"+p).addClass("checked")}if(n!=null&&n!=""){calcShopCheck(g,n)}if(g.Num==g.checkedWareNum){$("#checkIcon-1").addClass("checked")}else{$("#checkIcon-1").removeClass("checked")}judgeSubmit(g.checkedWareNum,g.GlobalNum,g.LocalNum,g.MedicineNum)}else{$("#notEmptyCartLogin").hide();$("#emptyCartLogin").show();$("#notEmptyCart").hide();$("#payment_p").hide();$("#emptyCart").show();$("#informExpoCoup").hide();var b=$("#sid").val();var x=$("#isShowActivityLayer").val();if(x=="true"){var y="/cart/activityLayer.action";jQuery.get(y,function(e){if(e!=null){$(".operating-floor-container").append(e);if($(".operating-floor-one").length>0){$(".operating-floor-only").height($(".operating-floor-only").width()/3.57)}if($(".operating-floor-three").length>0){unifyHeight($(".operating-floor-three"),$(".operating-floor-three").find(".operating-floor-txt span").height())}if($(".operating-floor-four").length>0){unifyHeight($(".operating-floor-four"),$(".operating-floor-four").find(".operating-floor-txt span").height())}}})}var h=$("#isShowMiaoShaLayer").val();if(h=="true"){var y="/cart/miaoShaLayer.action";jQuery.get(y,function(i){if(i!=null&&i!=""){document.getElementById("secKillArea").innerHTML=i;var e=$("#timeRemain").val();krystal.cartSecKill.init({timeRemain:e})}})}else{document.getElementById("secKillArea").style.display="none"}var a=$("#isShowRecommend").val();if(a=="true"){new Recommend({containerID:"emptyRecommendID",url:"/cart/guessYouLikeUnify.json?emptyCart=true&sid="+b,maxCount:60,everyPage:30,pageCount:2,callBack:function(){jQuery.loadImg.lazyLoad({rangeH:document.documentElement.clientHeight})}})}$(".shopping-guess-container").hide();$("#body").css("background","")}}catch(v){}spinerHide()};var calcCartGifts=function(s,d){try{if(!isBlank(s.cart)&&!!s.cart.vendors){s=s.cart;document.getElementById("cart_oriPrice").innerHTML=s.Price.toFixed(2);document.getElementById("cart_rePrice").innerHTML=s.RePrice.toFixed(2);document.getElementById("cart_realPrice").innerHTML=s.PriceShow;var a;if(s.checkedWareNum>99){a="99+"}else{a=s.checkedWareNum}document.getElementById("checkedNum").innerHTML="\u0028"+a+"\u0029";var t=s.vendors;var r;var u;var f;var l;for(var n=0;n<t.length;n++){l=0;if(t[n].vendorId==d){l=1}r=t[n].sorted;for(var h=0;h<r.length;h++){if(r[h].itemType==1||r[h].itemType==4){continue}u=r[h].item;f=u.Id;if(l==1||d==-2||f==d){var o="<div class='diver-hr-dashed'></div> <span class='shop-footer-total font13'>\u5c0f\u8ba1\u003a<i>"+u.PriceShow+"</i></span>";if(u.RePrice>0){o=o+"<span class='shop-footer-cashback'>\u7acb\u51cf\u003a<i class='money-unit-bf'>"+u.RePrice.toFixed(2)+"</i></span>"}$("#shopfooter"+f).html(o);if(u.STip){$("#sTip"+f).html(u.STip);if($("#isNewCartPromotion").val()=="true"){if(u.entryLabel!=undefined){$("#sTipEntrance"+f).html(u.entryLabel)}}else{if(u.fullRefundType!=undefined&&u.fullRefundType==24){if(u.entryLabel!=undefined){$("#sTipEntrance"+f).html(u.entryLabel)}}else{if(u.promoCase!=undefined&&u.promoCase==true){$("#sTipEntrance"+f).html("\u53bb\u51d1\u5355")}else{$("#sTipEntrance"+f).html("\u518d\u901b\u901b")}}}}var c=$("#sid").val();var b="";if(u.AddMoney==0&&u.Gifts.length>0){b+='<div class="clear"></div>'}for(var m=0;m<u.Gifts.length;m++){var p=u.Gifts[m];b+='<input type="hidden" name="showgift'+u.Id+'" class="cart-suit-showgift-input" value="'+p.Id+'">';if(u.AddMoney>0||u.fullRefundType==24){b+='<div class="clear"></div>';b+='<div class="items">';b+='<div class="shp-cart-item-core shop-cart-display sub-product-display';if(p.stockState=="\u65e0\u8d27"){b+=" cart-noshopping"}b+='"><a class="cart-product-cell-1 shp-cart-tag-trade"';b+=' href="https://item.m.jd.com/product/'+p.Id+".html?sid="+c+'">';b+='<img class="cart-photo-thumb" alt="" ';b+='src="//img10.360buyimg.com/n7/'+p.ImgUrl+'"';if(p.stockState=="\u65e0\u8d27"){b+="<i></i>"}b+='</a><div class="cart-product-cell-2"><div class="cart-product-name">';b+='<a href="https://item.m.jd.com/product/'+p.Id+".html?sid="+c+'">';b+='<span><em class="icon-condition" id="gift-info-sign">\u6362\u8d2d</em>'+p.Name+"</span>";b+='</a></div><div class="cart-product-cell-3"><span class="shp-cart-item-price" id="price'+p.Id+'">';b+=processPrice(""+p.PriceShow);b+='</span></div><div class="cart-product-cell-5"><span class="num-cont-show">'+p.Num+"</span>";b+='<div class="shop-btn-com">';b+='<a class="cart-new-btn" onclick="deleteGifts(this,'+t[n].shopId+","+t[n].vendorId+","+u.Id+","+u.Num+","+u.SType+","+p.Id+","+p.Num+')"><span class="right-boundary"></span><span class="btn-msg-in">\u5220\u9664</span></a></div></div></div></div></div>'}else{b+='<div class="items">';b+='<div class="shp-cart-item-core shop-cart-display sub-product-display';if(p.stockState=="\u65e0\u8d27"){b+=" cart-noshopping"}b+='"><a class="cart-product-cell-1 shp-cart-tag-trade" href=';b+="https://item.m.jd.com/product/"+p.Id+".html?sid="+c+"'";b+='><img class="cart-photo-thumb" alt="" src="//img10.360buyimg.com/n7/'+p.ImgUrl+'">';if(p.stockState=="\u65e0\u8d27"){b+="<i></i>"}b+="</a>";b+='<div class="cart-product-cell-2"><div class="cart-product-name"><a href=';b+='"https://item.m.jd.com/product/'+p.Id+".html?sid="+c+'">';b+="<span>";b+='<em class="icon-condition" id="gift-info-sign">\u8d60\u54c1</em>'+p.Name;b+="</span></a>";b+='</div><div class="cart-product-cell-3"><span class="shp-cart-item-price" id="price'+p.Id+'">';b+=processPrice(""+p.PriceShow);b+="</span></div>";b+='<div class="cart-product-cell-5"><span class="num-cont-show">'+p.Num+'</span><div class="shop-btn-com">';b+='<a class="cart-new-btn" onclick="deleteGifts(this,'+t[n].shopId+","+t[n].vendorId+","+u.Id+","+u.Num+","+u.SType+","+p.Id+","+p.Num+')"><span class="right-boundary"></span><span class="btn-msg-in">\u5220\u9664</span></a></div></div></div>';b+="</div>";b+="</div>"}}$("#givenGift"+f).html(b);if(u.Gifts.length>0){$("#giftBlackLine"+f).addClass("clear mart10")}else{$("#giftBlackLine"+f).removeClass("clear mart10")}if(u.Gifts.length==0){$("#hidegiftSelectNum"+f).val(0)}if(u.CanSelectGifts.length>0){makeChooseGift(u.Id,u.Num,u.SType,u.CheckType,u.CanSelectGifts,u.Gifts.length,u.CanSelectedGiftNum,u.AddMoney)}var v=$("#notGivenGift"+u.Id);if(u.CanSelectedGiftNum>0&&u.CanSelectGifts&&u.CanSelectGifts.length>0){$("#notGivenGift"+u.Id).removeClass("disabled-act-btn")}else{$("#notGivenGift"+u.Id).addClass("disabled-act-btn")}if(u.AddMoney&&u.AddMoney>0){if(u.Gifts&&u.Gifts.length>0){$("#notGivenGiftMsg"+u.Id).html("\u91cd\u65b0\u6362\u8d2d")}else{if(u.promoCase!=undefined&&u.promoCase==false){$("#notGivenGiftMsg"+u.Id).html("\u6362\u8d2d\u5546\u54c1")}else{$("#notGivenGiftMsg"+u.Id).html("\u67e5\u770b\u6362\u8d2d")}}}else{if(u.Gifts&&u.Gifts.length>0){$("#notGivenGiftMsg"+u.Id).html("\u91cd\u65b0\u9886\u53d6")}else{if(u.promoCase!=undefined&&u.promoCase==false){$("#notGivenGiftMsg"+u.Id).html("\u9886\u53d6\u8d60\u54c1")}else{$("#notGivenGiftMsg"+u.Id).html("\u67e5\u770b\u8d60\u54c1")}}}$("span[name='optionsGift']").removeClass("checked")}}}judgeSubmit(s.checkedWareNum,s.GlobalNum,s.LocalNum,s.MedicineNum)}else{$("#notEmptyCart").hide();$("#payment_p").hide();$("#emptyCart").show();$(".shopping-guess-container").hide();$("#body").css("background","")}}catch(q){}spinerHide()};var calcCartShop=function(b,a){try{var d=$("div[data-vendorid="+a+"] li[name=productGroup"+b+"]");if(d.size()==0){$("div[data-vendorid="+a+"]").hide()}}catch(c){}};var calcCartPrice=function(m,a){try{if(!isBlank(m.cart)&&!!m.cart.vendors){var n=m.cart.vendors;var l;var o;var f;var h;for(var d=0;d<n.length;d++){l=n[d].sorted;for(var b=0;b<l.length;b++){o=l[b].item;if(l[b].itemType==1){if(a==-2||o.Id==a){if($.trim($("#price"+o.Id).html())!=processPrice(o.PriceShow)){$("#price"+o.Id).html(processPrice(o.PriceShow))}}}else{f=o.Skus;for(var c=0;c<f.length;c++){h=f[c];if(a==-2||h.Id==a){if($.trim($("#price"+o.Id+h.Id).html())!=processPrice(h.PriceShow)){$("#price"+o.Id+h.Id).html(processPrice(h.PriceShow))}}}}}}}}catch(g){}};var makeChooseGift=function(c,j,a,b,h,l,o,d){if($("#chooseGifts"+c).html()==""){return}var n='<input type="hidden" id="hidegiftSelectNum'+c+'" value="'+l+'"><input type="hidden" id="hidegiftSelectType'+c+'" value="'+d+'" ><div class="additional-list-items" ><div class="additional-list-header"><span class="additional-list-header-right"><a class="btn-jd-red" href="javascript:hideChooseGifts(\''+c+'\')">\u786e\u5b9a</a></span>\u5df2\u9009\u62e9 <span class="highlight"><span id="giftSelectNum'+c+'">'+l+"</span>/"+o+'</span> \u4ef6</div><div class="additional-list-wrapper"><div class="additional-list-container"> ';var m="";for(var f=0;f<h.length;f++){var e=h[f];m+='<div class="additional-items"><div class="item-wrapper"><div class="additional-item-content" onclick="beCartGiftDetail('+e.Id+","+d+')"><div class="cart-product-name"><a href="#" style="cursor:default;"><span>'+e.Name+'</span></a></div><div class="shp-cart-promotion-opt"><span class="shp-cart-promotion-right"><span class="shp-cart-item-price">'+e.PriceShow+'</span></span><span class="shp-cart-promotion-left">';if(e.giftMsg){m+='<span class="icon-exchange">'+e.giftMsg+"</span>"}else{m+='<span class="shp-cart-amount">x '+e.Num+"</span>"}m+="</span></div></div></div>";if(!e.giftMsg){m+='<div class="additional-check-wrapper"><span id="'+c+e.Id+'" name="gift'+c+'"';if(e.CheckType==1){m+='class="cart-checkbox checked"'}else{m+='class="cart-checkbox"'}m+="data-gift='"+c+"@@"+j+"@@"+a+"@@"+e.Id+"@@"+e.Num+"'onclick=\"selectGifts('"+c+"',"+j+","+a+","+e.Id+","+e.Num+","+o+')"></span><input type="hidden" id="num'+c+e.Id+'" value="'+e.Num+'"><input type="hidden" id="giftId'+c+e.Id+'" value="'+e.Id+'"></div>'}m+='<div class="additional-item-thumb"><img class="cart-photo-thumb" alt="" src="//img10.360buyimg.com/n7/'+e.ImgUrl+'"></div>';m+='</div><div class="clear mart10"></div>'}var k="</div></div></div>";var g=n+m+k;$("#chooseGifts"+c).html(g)};var calcCartYanBao=function(h,a,n){try{if(!isBlank(h.cart)&&!!h.cart.vendors){h=h.cart;document.getElementById("cart_oriPrice").innerHTML=h.Price.toFixed(2);document.getElementById("cart_rePrice").innerHTML=h.RePrice.toFixed(2);document.getElementById("cart_realPrice").innerHTML=h.PriceShow;var m=h.vendors;var o;var l;var g;for(var c=0;c<m.length;c++){o=m[c].sorted;for(var b=0;b<o.length;b++){l=o[b];if(l.itemType==1){if(a==""||a==null){g=l.item;if(l.item.Id==n){showCartYanBao("","","",g);return}}}else{if(l.item.Id==a){var k=l.item;var f=k.Skus;for(var b=0;b<f.length;b++){g=f[b];if(g.Id==n){showCartYanBao(l.item.Id,l.item.Num,l.item.SType,g);return}}}}}}}else{$("#notEmptyCart").hide();$("#payment_p").hide();$("#emptyCart").show()}}catch(d){}finally{spinerHide()}};var showCartYanBao=function(c,e,a,i){var f;var h;if(i.YbSkus&&i.YbSkus.length>0){var g=i.YbSkus;f='<div id="showyanbao'+c+i.Id+'">';for(var d=0;d<g.length;d++){h=g[d];if(h&&h.MainYbSku){f+="<div>";f+='<a href="javascript:beYBDetail('+h.MainYbSku.Id+');" class="shp-cart-gift-list">\u005b\u670d\u52a1\u005d'+h.MainYbSku.Name;f+="<i>"+h.MainYbSku.PriceShow+"</i></a></div>"}}f+="</div>"}else{f=""}var b=$("#givenYanbao"+c+i.Id+" .shp-cart-gift-list");if(""!=f){if([]==b||b.length==0){$("#givenYanbao"+c+i.Id).html('<div class="shp-cart-gift-list">'+f+"</div>")}else{b.html(f)}}else{$("#givenYanbao"+c+i.Id).html(f)}};var disableSubmit=function(){$("#submit").unbind("click")};var enableSubmit=function(c,e,a){var g=d(e),b=d(c),f=d(a);if(!g&&!b&&!f){return}if(g&&!b&&!f){$("#submitType").val(1);$("#submit").unbind("click");$("#submit").bind("click",submit);return}if(!g&&b&&!f){$("#submitType").val(2);$("#submit").unbind("click");$("#submit").bind("click",submit);return}if(!g&&!b&&f){$("#submitType").val(3);$("#submit").unbind("click");$("#submit").bind("click",submit);return}$("#submit").unbind("click");$("#submit").bind("click",function(){popModal({globalPrice:"0.00",localPrice:"0.00",globalNum:c,localNum:e,medicineNum:a,callback:function(){var i=document.querySelectorAll('input[name="shopping"]');for(var h=0,j=i.length;h<j;h++){if(i[h].checked){$("#submitType").val(i[h].dataset.subtype);submit();break}}}})});function d(h){h=parseInt(h);if(typeof h!="undefined"&&h&&!isNaN(h)){return true}}};var judgeSubmit=function(d,b,c,a){if(d<=0){disableSubmit();$("#checkAll").removeClass("checked")}else{enableSubmit(b,c,a)}};var appendSuit=function(e,f,b,d,c,a){if(!isBlank(e)){if(!isBlank(f)){e+="&sType="+f}if(!isBlank(b)){e+="&suitSkuId="+b}if(!isBlank(d)){e+="&suitSkuNum="+d}if(!isBlank(c)){e+="&ybId="+c}if(!isBlank(a)){e+="&ybNum="+a}}return e};var submit=function(){var h=document.getElementById("cart_realPrice").innerHTML;var a=$("#submitType").val();if(typeof a!="undefined"){a=parseInt(a)}else{return}if(Number(h)<=0){return}var c;if(a==1){var g=$("#normalSkus").val();c="/norder/order.action?enterOrder=true&sid="+$("#sid").val();setTimeout(function(){pingClick(cartUse,"MShopcart_Pay",g,"submit","http://p.m.jd.com/norder/order.action","","A")},0)}else{if(a==2){var f=$("#globalSkus").val();var e=$("#jumpHkURL").val();c="https://"+e+"/norder/order.action?fromType=hk&enterOrder=true&sid="+$("#sid").val();setTimeout(function(){pingClick(cartUse,"MShopcart_Pay",f,"submit","","","D")},0)}else{if(a==3){var b=$("#otcMedicineUrl").val();if(b){var d=$("#otcSkus").val();c=b;setTimeout(function(){pingClick(cartUse,"MShopcart_Pay",d,"submit","","","C")},0)}else{c="/cart/errorPage"}}else{return}}}setTimeout(function(){window.location.href=c},100)};var isBlank=function(a){if(a==undefined||a==null||a.length==0){return true}else{return false}};var deSelectedAll=function(){var b=-2;$("#checkIcon"+b).removeClass("checked");spinerShow();var a="/cart/check.json?checked="+8+"&sid="+$("#sid").val();jQuery.get(a,{},function(c){if(c!=undefined){checkInterface(c);calcCartCheck(c,b);calcCartGifts(c,b);checkFreightEntrance(c);commonCheck(c);spinerHide()}else{if($("#checkIcon"+b).hasClass("checked")){$("#checkIcon"+b).removeClass("checked")}else{$("#checkIcon"+b).addClass("checked")}}},"json")};var selectedAll=function(){var b=-2;$("#checkIcon"+b).addClass("checked");spinerShow();var a="/cart/check.json?checked="+7+"&sid="+$("#sid").val();jQuery.get(a,{},function(c){if(c!=undefined){checkInterface(c);calcCartCheck(c,b);calcCartGifts(c,b);checkFreightEntrance(c);commonCheck(c);spinerHide()}else{if($("#checkIcon"+b).hasClass("checked")){$("#checkIcon"+b).removeClass("checked")}else{$("#checkIcon"+b).addClass("checked")}}},"json")};var checkAllHandler=function(){if($("#checkIcon-1").hasClass("checked")){$("#checkIcon-1").removeClass("checked ");deSelectedAll()}else{$("#checkIcon-1").addClass("checked");selectedAll();pingClick(cartUse,"MShopcart_CheckAll","","","")}};var setFixTip=function(b,a){window.onscroll=function(){var d=document.documentElement.scrollTop||document.body.scrollTop;var c=$("#"+a).offset().top;if(d>=c-10){$("#"+b+"p").css("height",$("#"+b).height());$("#"+b).css("position","fixed");$("#"+b).css("z-index","10001");$("#"+b).css("top","0px");$("#"+b).css("border-bottom","1px solid #e4393c")}else{$("#"+b+"p").css("height","0px");$("#"+b).css("position","");$("#"+b).css("z-index","");$("#"+b).css("border-bottom","0px solid #e4393c");$("#"+b).css("top",$("#"+a).offset().top+"px")}}};var addWareBybutton=function(i,b,e,a,l,c,m,d){var h=0;var f;if(isBlank(e)||(!isBlank(a)&&a==4)){f=b}else{f=l}h=Number($("#num"+f).val())+1;var k=parseInt($("#limitSukNum"+f).val());var j=parseInt($("#remainNumInt"+f).val());if(h>k||(h>j&&j>=0)){return}if(h>1){$("#subnum"+f).removeClass("disabled")}if(h>=j&&j>=0){$("#addnum"+f).addClass("disabled")}if(h==k){$("#addnum"+f).addClass("disabled")}if(isBlank(e)||(!isBlank(a)&&a==4)){e=h}else{c=h}var g="/cart/modify.json?wareId="+b+"&num="+e+"&sid="+$("#sid").val();g=appendSuit(g,a,l,c,m,d);spinerShow();jQuery.get(g,{},function(n){checkInterface(n);calcCartCheck(n,f,i,true);calcCartGifts(n,b);calcCartPrice(n,f);commonCheck(n);checkFreightEntrance(n);$("span[name='suitSkuNum"+b+"']").text(h);setDefiniteNumById(n,f);judgeLeastNumState(f);pingClick(cartUse,"MShopcart_EditAmount",f,"addWareBybutton","http://p.m.jd.com/cart/modify.action")},"json")};var subWareBybutton=function(i,b,e,a,k,c,l,d){var h=0;var f;if(isBlank(e)||(!isBlank(a)&&a==4)){f=b}else{f=k}h=Number($("#num"+f).val())-1;var j=parseInt($("#remainNumInt"+f).val());if(h<=0){return}if(h>j&&j>=0){h=j}if(h==1){$("#subnum"+f).addClass("disabled")}if(h<parseInt($("#limitSukNum"+f).val())){$("#addnum"+f).removeClass("disabled")}if(h>=j&&j>=0){$("#addnum"+f).addClass("disabled")}if(isBlank(e)||(!isBlank(a)&&a==4)){e=h}else{c=h}var g="/cart/modify.json?wareId="+b+"&num="+e+"&sid="+$("#sid").val();g=appendSuit(g,a,k,c,l,d);spinerShow();jQuery.get(g,{},function(m){checkInterface(m);calcCartCheck(m,f,i,true);calcCartGifts(m,b);calcCartPrice(m,f);checkFreightEntrance(m);commonCheck(m);$("span[name='suitSkuNum"+b+"']").text(h);setDefiniteNumById(m,f);judgeLeastNumState(f);pingClick(cartUse,"MShopcart_EditAmount",f,"subWareBybutton","http://p.m.jd.com/cart/modify.action")},"json")};var selectYanbao=function(d,j,b,m,f,o,h,e){if($("#"+d+m+o).hasClass("checked")){deleteYanBao(d,j,b,m,f,o,h);$("#"+d+m+o).removeClass("checked")}else{var a=""+d+m+e;var k=document.getElementsByName(a);var c;var n;for(var g=0;g<k.length;g++){var l=k[g];if(l.className=="cart-checkbox checked"){l.className="cart-checkbox"}}$("#"+d+m+o).addClass("checked")}};var addYanbao=function(e,l,b,p,f){var q=null;var k=null;var m=e+p;var d=document.getElementsByName("brandId"+m);for(var h=0;h<d.length;h++){var c=d[h].value;var a=""+e+p+c;var n=document.getElementsByName(a);for(var g=0;g<n.length;g++){var o=n[g];if(o.className=="cart-checkbox checked"){platformId=$("#ybId"+o.id).val();platformNum=$("#num"+o.id).val();if(q==null){q=platformId;k=platformNum}else{q+="@@"+platformId;k+="@@"+platformNum}}}}if(q!=null){addCartWare(e,l,b,p,f,q,k)}else{showYanbao(e,p)}hideChooseYanBao(e,p)};var showYanbao=function(c,b){var a="/cart/cart.json?sid="+$("#sid").val();spinerShow();jQuery.get(a,{},function(d){checkInterface(d);calcCartYanBao(d,c,b);checkFreightEntrance(d);commonCheck(d)},"json")};var beWalk=function(){var b=$("#sid").val();var a="https://m.jd.com/index.html";pingClick(cartUse,"MShopcart_Stroll","","beWalk",a);if(b!=null&&b==""){a+="?sid="+b}window.location.href=a};function generateForm(c){var a=document.querySelector("form.post-form-tmp");if(a){a.parentNode.removeChild(a)}var b=document.createElement("form");b.classList.add("post-form-tmp");var d=document.createElement("input");d.type="hidden";d.name=c.key;d.value=c.value;b.appendChild(d);document.body.appendChild(b);b.method="POST";b.action=c.url;return b}var beMSearchPromotion=function(d,f,c,h,e){var b=$("#sid").val();var a="https://so.m.jd.com/list/redemption.action?activityId="+d;var g=generateForm({url:a,key:"activityTip",value:f});g.submit()};var beMSearchPage=function(c,b,g,a,e){var d=$("#sid").val();var f="https://so.m.jd.com/list/cartSearch.action?activityId="+c+"&skuId="+g;if(cartUse){var i;if(a==11){i="manjian"}else{if(Number(e)>0){i="jiajiagou"}else{i="manzeng"}}pingClick(cartUse,"MShopcart_Label",i,"beActPage",f)}var h=generateForm({url:f,key:"activitySTip",value:b});h.submit()};var beActPage=function(e,f,d){var b=$("#sid").val();var a="";a="https://"+e;if(cartUse){var c;if(f==11){c="manjian"}else{if(Number(d)>0){c="jiajiagou"}else{c="manzeng"}}pingClick(cartUse,"MShopcart_Label",c,"beActPage",a)}window.location.href=a};var beLoginEmptyCart=function(a){pingClick(cartUse,"MShopcart_LoginEmptyCart","","beLoginEmptyCart",a);window.location.href=a};var beShop=function(b){var c=$("#isOpenNewShop").val();var a="";if(c=="true"){a="https://shop.m.jd.com/?shopId="+b}else{a="https://ok.jd.com/m/index-"+b+".htm"}pingClick(cartUse,"MShopcart_ShopEntrance",b,"beShop",a);window.location.href=a};var beLogin=function(a){pingClick(cartUse,"MShopcart_LoginFullCart","","beLogin",a);window.location.href=a};var beSimilar=function(c){var b=$("#sid").val();var d=$("#isNewLookSimilar").val();var a="";if(d=="true"){a="https://home.m.jd.com/myjd/similar/list.action?skuId="+c}else{a="/cart/lookSimilarA.action?wareId="+c+"&sid="+b}pingClick(cartUse,"MShopcart_SimilaritiesEntrance","","beSimilar",a);window.location.href=a};var getSelfSkuParams=function(){var c=$("input[name='skuIds8888']");var e=$("input[name='skuIdSelected8888']");var g=$("input[name='suitIds8888']");var f=$("input[name='suitIdSelected8888']");var b="";var a=0;for(var d=0;d<c.length;d++){if(c.get(d).value.length>8){continue}if(a==10){break}if(b==""){if(e.get(d).value==1){b=c.get(d).value;a++}}else{if(e.get(d).value==1){b=b+","+c.get(d).value;a++}}}for(var d=0;d<g.length;d++){if(g.get(d).value.length>8){continue}if(a==10){break}if(b==""){if(f.get(d).value==1){b=g.get(d).value;a++}}else{if(f.get(d).value==1){b=b+","+g.get(d).value;a++}}}return b};var freeFreight=function(){if($("#freeFreight").hasClass("title-btn-disabled")){return}var c=$("#sid").val();var j=$("input[name='skuIds8888']");var g=$("input[name='skuIdSelected8888']");var b=$("input[name='suitIds8888']");var l=$("input[name='suitIdSelected8888']");var d="";var m=0;for(var h=0;h<j.length;h++){if(j.get(h).value.length>8){continue}if(m==10){break}if(d==""){if(g.get(h).value==1){d=j.get(h).value;m++}}else{if(g.get(h).value==1){d=d+","+j.get(h).value;m++}}}for(var h=0;h<b.length;h++){if(b.get(h).value.length>8){continue}if(m==10){break}if(d==""){if(l.get(h).value==1){d=b.get(h).value;m++}}else{if(l.get(h).value==1){d=d+","+b.get(h).value;m++}}}var a=$("#freeFreightPrice").val();var n="";var e=$("#isFreshFreight").val();var p=$("#normalCheckedSkus").val();var o=$("#freshCheckedSkus").val();n="/cart/freeFreightNew.action?sid="+c+"&normalCheckedSkus="+p+"&freshCheckedSkus="+o;var f=$("#FreightnoteEventParam").val();var k=$("#FreightnotePageParam").val();pingClick(cartUse,"MShopcart_Freightnote",f,"","","4",k);setTimeout(function(){window.location.href=n},100)};var popFreeFreight=function(n,m){var b=$("#sid").val();var f=$("input[name='skuIds"+n+"']");var d=$("input[name='skuIdSelected"+n+"']");var a=$("input[name='suitIds"+n+"']");var h=$("input[name='suitIdSelected"+n+"']");var c="";var g=0;for(var e=0;e<f.length;e++){if(g==10){break}if(c==""){if(d.get(e).value==1){c=f.get(e).value;g++}}else{if(d.get(e).value==1){c=c+","+f.get(e).value;g++}}}for(var e=0;e<a.length;e++){if(g==10){break}if(c==""){if(h.get(e).value==1){c=a.get(e).value;g++}}else{if(h.get(e).value==1){c=c+","+a.get(e).value;g++}}}var k=1;var l=30;var j="/cart/popFreeFreight.action?skusParam="+c+"&sid="+b+"&PopVendorId="+n+"&popShopId="+m+"&recommendPage="+k+"&recommendPageSize="+l;pingClick(cartUse,"MShopcartsale_SingleJoin","","","","4");setTimeout(function(){window.location.href=j},100)};function getSkuIds(){var c=$("input[name='skuIds']");var e=$("input[name='skuIdSelected']");var g=$("input[name='suitIds']");var f=$("input[name='suitIdSelected']");var b="";var a=0;for(var d=0;d<c.length;d++){if(c.get(d).value.length>7){continue}if(a==10){break}a++;if(b==""){if(e.get(d).value==1){b=c.get(d).value}}else{if(e.get(d).value==1){b=b+","+c.get(d).value}}}for(var d=0;d<g.length;d++){if(g.get(d).value.length>7){continue}if(a==10){break}a++;if(b==""){if(f.get(d).value==1){b=g.get(d).value}}else{if(f.get(d).value==1){b=b+","+g.get(d).value}}}}var pingClick=function(c,h,j,f,i,g,b){if(c){try{var k=new MPing.inputs.Click(h);k.event_param=j;k.event_level=g;if(b!=undefined&&b!=""){k.page_param=b}var a=new MPing();a.send(k)}catch(d){}}};var pingCartDel=function(a,f,d,c){if(a){try{var h=new MPing.inputs.RmCart(f,c);h.event_param=d;var b=new MPing();b.send(h)}catch(g){}}};var pingCartAdd=function(b,f,d,a){if(b){try{var h=new MPing.inputs.AddCart(f,a);h.event_param=d;var c=new MPing();c.send(h)}catch(g){}}};var timerEvt;function toaster(a,i,f){clearTimeout(timerEvt);timerEvt=function(){return false};var b=2000;if($("#popup_block").length==0){$("body").append('<div id="popup_block" class="pop-block"><div class="popup_wrapper"><div class="popup_title"></div><div class="popup_content"></div></div></div>')}var l=$("#popup_block");$("#popup_block .popup_content").html(a);$("#popup_block .popup_title").html(i);var g=(f)?"nowrap":"inherit";$("#popup_block").show();var k=window.pageXOffset||document.documentElement.scrollLeft||document.body.scrollLeft;var c=document.documentElement.clientWidth||document.body.clientWidth;var j=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop;var d=document.documentElement.clientHeight||document.body.clientHeight;var e=(d-$("#popup_block").height())/2+j;var h=(c-$("#popup_block").width())/2+k;l.css({top:e,left:h,"white-space":g});timerEvt=setTimeout(function(){$("#popup_block").hide()},b)}var popModal=function(f){var j=false,t=false,n=false,s="";var o={callback:null};var v=jQuery.extend(o,f);var w;var a="\u5168\u7403\u8d2d\u5546\u54c1";var k="\u5176\u4ed6\u5546\u54c1";var h="\u8fd4\u56de\u8d2d\u7269\u8f66";var l="\u53bb\u7ed3\u7b97";var q="\u533b\u836f\u5546\u54c1";if(v.globalNum&&v.globalNum>0){t=true}if(v.medicineNum&&v.medicineNum>0){n=true}if(v.localNum&&v.localNum>0){j=true}if(t&&n&&j){w="\u62b1\u6b49\uff0c\u60a8\u7684\u8d2d\u7269\u8f66\u5305\u542b\uff1a\u5168\u7403\u8d2d\u5546\u54c1\u3001\u533b\u836f\u5546\u54c1\uff0c\u9700\u548c\u5176\u4ed6\u5546\u54c1\u5206\u5f00\u7ed3\u7b97\uff01"}else{if(!t&&n&&j){w="\u62b1\u6b49\uff0c\u60a8\u7684\u8d2d\u7269\u8f66\u5305\u542b\uff1a\u533b\u836f\u5546\u54c1\uff0c\u9700\u548c\u5176\u4ed6\u5546\u54c1\u5206\u5f00\u7ed3\u7b97\uff01"}else{if(t&&!n&&j){w="\u62b1\u6b49\uff0c\u60a8\u7684\u8d2d\u7269\u8f66\u5305\u542b\uff1a\u5168\u7403\u8d2d\u5546\u54c1\uff0c\u9700\u548c\u5176\u4ed6\u5546\u54c1\u5206\u5f00\u7ed3\u7b97\uff01"}else{if(t&&n&&!j){w="\u62b1\u6b49\uff0c\u60a8\u7684\u8d2d\u7269\u8f66\u5305\u542b\uff1a\u5168\u7403\u8d2d\u5546\u54c1\u3001\u533b\u836f\u5546\u54c1\uff0c\u9700\u5206\u5f00\u7ed3\u7b97\uff01"}}}}var r="";r+='<div id="pop-modal" class="pop-floor" style="display:none;">';r+='<div class="cover-floor"></div>';r+='<div class="info-box">';r+="<form>";r+='<div class="info-box-content" id="pop-info">'+w+"</div>";r+='<div class="info-box-item">';if(t){if(""==s){s='checked="checked"'}else{s=""}r+='<div class="options">';r+='<div class="options-check-wrapper">';r+='<input type="radio" id="internationalID" name="shopping"  '+s+'  data-subtype="2" class="cssRadio"/>';r+='<label class="btnClass" for="internationalID"></label>';r+="</div>";r+='<div class="options-content">';r+='<div class="options-title" id="pop-title-international">'+a+"</div>";r+='<div class="options-info"><span id="international-numbersID">0</span>\u4ef6</div>';r+="</div>";r+="</div>"}if(n){if(""==s){s='checked="checked"'}else{s=""}r+='<div class="options">';r+='<div class="options-check-wrapper">';r+='<input type="radio" id="medicineOTCID" name="shopping"  '+s+'  data-subtype="3" class="cssRadio"/>';r+='<label class="btnClass" for="medicineOTCID"></label>';r+="</div>";r+='<div class="options-content">';r+='<div class="options-title" id="pop-title-international">'+q+"</div>";r+='<div class="options-info"><span>'+v.medicineNum+"</span>\u4ef6</div>";r+="</div>";r+="</div>"}if(j){r+='<div class="options">';r+='<div class="options-check-wrapper">';r+='<input type="radio" id="otherID" name="shopping" data-subtype="1" class="cssRadio"/>';r+='<label class="btnClass" for="otherID"></label>';r+="</div>";r+='<div class="options-content">';r+='<div class="options-title" id="pop-title-regular">'+k+"</div>";r+='<div class="options-info"><span id="other-numbersID">0</span>\u4ef6</div>';r+="</div>";r+="</div>"}r+="</div>";r+='<div class="btn-box">';r+='<a href="#jd" class="btn-box-back" id="back-to-cart">'+h+'</a><span class="btn-box-space"></span><a href="#jd" class="btn-box-check" id="continue-payment">'+l+"</a>";r+="</form></div>";r+="</div>";r+="</div>";var d,b,i,m,e,g,z,y,x;var c={initModal:function(){$("body").append(r);b=$("#pop-modal");z=b.find(".info-box");y=z.width();x=(j&&t&&n)?341:280;mdlForm=b.find("form").eq(0);i=$("#international-numbersID");m=$("#other-numbersID");e=$("#back-to-cart");g=$("#continue-payment");d=$("body").height();$(".cover-floor").css({height:d});var A=parseInt((document.documentElement.clientWidth-y)/2);var B=parseInt((document.documentElement.clientHeight-x)/2);z.css({marginLeft:A,marginTop:B})},show:function(){b.show()},hide:function(){b.remove()},clear:function(){mdlForm.reset()},draw:function(){i.html(v.globalNum);m.html(v.localNum)}};var u=function(){c.initModal();c.draw();c.show();p()};var p=function(){e.unbind("click");g.unbind("click");e.bind("click",function(){pingClick(cartUse,"MGlobalCart_BacktoCart","international","","http://p.m.jd.com/cart/cart.action");c.hide()});g.bind("click",function(){v.callback();c.hide()})};return u()};var selectGroup=function(e){var d=6;var b=$(".group-"+e);var c="";if($("#checkShop"+e).hasClass("checked")){$("#checkShop"+e).removeClass("checked");b.each(function(){if($(this).hasClass("checked")){$(this).removeClass("checked")}var f=$(this).attr("data-sku");if(f!=null){if(c==""){c=f}else{c=c+"@@@"+f}}})}else{$("#checkShop"+e).addClass("checked");b.each(function(){if(!$(this).hasClass("checked")){$(this).addClass("checked")}var f=$(this).attr("data-sku");if(f!=null){if(c==""){c=f}else{c=c+"@@@"+f}}});d=5}var a="/cart/checkWares.json?wareInfos="+c+"&checked="+d+"&sid="+$("#sid").val();spinerShow();jQuery.get(a,{},function(f){if(f!=undefined){checkInterface(f);calcCartCheck(f,"");calcCartGifts(f,e);checkFreightEntrance(f);commonCheck(f);spinerHide()}else{if($("#checkShop"+e).hasClass("checked")){$("#checkShop"+e).removeClass("checked");b.each(function(){if($(this).hasClass("checked")){$(this).removeClass("checked")}})}else{$("#checkShop"+e).addClass("checked");b.each(function(){if(!$(this).hasClass("checked")){$(this).addClass("checked")}})}}},"json")};var popMessage=function(m){var g={callback:null};var e=$.extend(g,m);var d=e.description||"\u786e\u5b9a\u8981\u5220\u9664\u5417\u003f";var h=e.cancelText||"\u53d6\u6d88";var f=e.saveText||"\u786e\u5b9a";var n="";n+='<div class="cart-pop-floor" id="pop-delete">';n+='<div class="cart-cover-floor"></div>';n+=' <div class="cart-info-box">';n+=' <div class="cart-info-box-content cart-bdb-1px">';n+=' <span class="cart-info-box-text">'+d+"</span>";n+=' </div><div class="cart-btn-box">';n+=' <a class="cart-btn-box-back" id="cancel">'+h+"</a>";n+=' <a  class="cart-btn-box-check" id="isok">'+f+"</a>";n+=" </div></div></div>";var j,c,a,i;var k={initModel:function(){$("body").append(n);c=$("#pop-delete");a=$("#cancel");i=$("#isok");j=$("body").height();var o=parseInt((document.documentElement.clientWidth-284)/2);var p=parseInt((document.documentElement.clientHeight-146)/2);$(".cart-info-box").css({marginLeft:o,marginTop:p})},show:function(){c.show()},hide:function(){c.show()}};var l=function(){k.initModel();c.show();b()};var b=function(){a.unbind("click");i.unbind("click");a.bind("click",function(){e.callback(false);c.hide();c.remove()});i.bind("click",function(){e.callback(true);c.hide();c.remove()})};return l()};function controlPop(b){var e={maskID:"mask"};var c=$.extend(e,b);var a=document.getElementById(c.maskID);var d=function(){var f=document.getElementById("mask-click-hidden");if(f==null){f=document.createElement("div");f.className="mask-click-hidden";f.id="mask-click-hidden";a.appendChild(f)}f.addEventListener("click",function(){a.style.display="none"})};return d()}var calcShopCheck=function(d,f){try{if(!isBlank(d)){var g=d.vendors;var h;var k;var c;var j;if(f==null){for(var a=0;a<g.length;a++){h=g[a].vendorId;k=$(".group-"+h);j=k.length;c=k.filter(".checked").length;if(j==c){$("#checkShop"+h).addClass("checked")}else{$("#checkShop"+h).removeClass("checked")}}}else{for(var a=0;a<g.length;a++){h=g[a].vendorId;if(f==h){k=$(".group-"+h);j=k.length;c=k.filter(".checked").length;if(j==c){$("#checkShop"+h).addClass("checked")}else{$("#checkShop"+h).removeClass("checked")}return}}}}}catch(b){}};var beWareDetail=function(b,c){var a="https://item.m.jd.com/product/"+b+".html";if(c=="jd"){a=a+"?dist=jd"}pingClick(cartUse,"MShopcart_Productid",b,"beWareDetail",a);window.location.href=a};var getShopCouppon=function(e,c,g){var a="https://coupon.m.jd.com/shopCoupon/popCouponNew.action?venderId="+e+"&skuCidParamForCoupon="+c;if(g.getAttribute("id")=="informExpoCoup"){var f=g.getAttribute("data-rid");a+="&couponRoleId="+f;$("#informExpoCoup").hide();var d=new Date();d.setTime(d.getTime()+600000);setCookie("couponInformExp",f,d.toGMTString(),"");pingClick(cartUse,"MShopcart_CouponLabel","","","")}var b="1";if("true"==$("#unLoginSign").val()){b="0"}pingClick(cartUse,"MShopcart_Coupon",b,"","","4");window.location.href=a};var getSelfCouppon=function(d,g){var b=$("#sid").val();var a="https://coupon.m.jd.com/selfCoupon/couponListNew.action?skuIdsCids="+d+"&sid="+b;if(g.getAttribute("id")=="informExpoCoup"){var f=g.getAttribute("data-rid");a+="&couponRoleId="+f;$("#informExpoCoup").hide();var e=new Date();e.setTime(e.getTime()+600000);setCookie("couponInformExp",f,e.toGMTString(),"");pingClick(cartUse,"MShopcart_CouponLabel","","","")}var c="1";if("true"==$("#unLoginSign").val()){c="0"}pingClick(cartUse,"MShopcart_SelfCoupon",c,"","");setTimeout(function(){window.location.href=a},100)};function backToTop(){var c=document.querySelector("#indexToTop");var b="click";var a={init:function(){a.scrollEvt();a.toTopEvt()},toTopEvt:function(){c.addEventListener(b,function(){scroll(0,0);c.style.display="none";pricePostTop(false);pingClick(cartUse,"MShopcart_Top","","","")},false)},scrollEvt:function(){window.addEventListener("scroll",function(){var d=document.documentElement.clientHeight||document.body.clientHeight;var e=document.documentElement.scrollTop||document.body.scrollTop;if(e==0){pricePostTop(false)}if(e>d){c.style.display="block"}else{c.style.display="none"}},false)}};return a.init()}var checkFreightEntrance=function(h){if(!isBlank(h.cart)&&!!h.cart.vendors){h=h.cart;var v=h.vendors;var p;var c;var q;var A=true;var r=$("#selfWeightFreeTip");var z=$("#selfFareType").val();var e=$("#sid");var l;if($("#isOpenFreeFreight").val()=="false"){A=false}var t=true;if($("#isOpenPopFreight").val()=="false"){t=false}if(!!v&&!!v.length){for(var w=0;w<v.length;w++){if(v[w].vendorId==8888){if(v[w].shopFreightMsg!=undefined){z=v[w].fareType;var f=h.selfFreightInfo;r.find(".free-tips").text(v[w].shopFreightMsg);if(z=="1"){r.unbind("click");r.find(".free-tips-icon .info").css("display","none");if(f!=undefined&&f.isOpenSelfFreightPage!=undefined&&f.isOpenSelfFreightPage){$("#selfFreightPageRed").html("\u53bb\u51d1\u5355");r.find(".free-tips-icon .left").css("display","block");pingClick(cartUse,"MShopcart_SelfFreightnoteAp","","","");r.bind("click",function(){try{l=""+h.ZYPrice+"_"+h.ZYWeight;pingClick(cartUse,"MShopcart_Freightnote",l,"","")}catch(i){}setTimeout(function(){window.location.href="/cart/freeFreight.action?sid="+e.val()+"&skusParam="+getSelfSkuParams()},100)})}}else{if(z=="2"||z=="3"){$("#selfFreightPageRed").html("");r.find(".free-tips-icon .info").css("display","block");r.find(".free-tips-icon .left").css("display","none");r.unbind("click")}else{$("#selfFreightPageRed").html("");r.find(".free-tips-icon .info").css("display","none");r.find(".free-tips-icon .left").css("display","none");r.unbind("click")}}}var C=document.querySelector("#shop-title-detail-JD");var x=document.querySelector(".cart-new-btn.marginLt10.self-coupon-btn");var b;var k='<span class="free-tips has-free-shipp">\u5df2\u514d\u8fd0\u8d39</span><span class="free-tips-icon"><i class="info"></i></span>';if(!x||x.style.display=="none"){b=false}else{b=true}$("#vendorPrice").val(v[w].vendorPrice);if((v[w].fareType==1||v[w].fareType==2)&&A&&!v[w].shopFreightMsg){$("#freeFreight").removeClass("title-btn-disabled");if(v[w].fareType==1){$("#freeFreight .free-freight-btn").attr("onclick","freeFreight()");$("#freeFreight").find(".freight-free-container").html('<span class="free-tips">\u51d1\u5355\u514d\u8fd0\u8d39</span>');pingClick(cartUse,"MShopcart_SelfFreightnoteAp","","","")}else{if(v[w].fareType==2){$("#freeFreight .free-freight-btn").attr("onclick","");$("#freeFreight").find(".freight-free-container").html(k);$(".free-tips-icon .info").bind("click",function(){var i;if($("#selfFareType").val()==2){i="MShopcart_FreeShipping"}else{if($("#selfFareType").val()==3){i="MShopcart_Overweight"}}pingClick("$!{cartUse}",i,"","","");jQuery.toast({titleName:"\u8fd0\u8d39\u8bf4\u660e\u89c4\u5219",message:$("#selfFreightMsg").val(),maxHeight:96,styleType:2,autoClose:false,btnNum:1,listContainer:body,btns:{okTxt:"\u6211\u77e5\u9053\u4e86"}})})}}$("#shop-title-detail-JD").remove()}else{if(b){C&&(C.parentNode.removeChild(C))}else{!C&&($("#freeFreight").append($('<span class="shop-title-8888" id="shop-title-detail-JD">'+$("#userGradeMessage").val()+"</span>")))}$("#freeFreight").addClass("title-btn-disabled")}var a=v[w].sorted;for(var u=0;u<a.length;u++){if(a[u].itemType==1){p=a[u].item;q=p.CheckType;$("#selected"+p.Id).val(q)}else{c=a[u].item;for(var d=0;d<c.Skus.length;d++){if(c.SType==4){q=c.CheckType;$("#selected"+c.Skus[d].Id).val(q)}else{q=c.Skus[d].CheckType;$("#selected"+c.Skus[d].Id).val(q)}}}}}else{if(v[w].freeFreight!=undefined&&v[w]!=undefined){if(v[w].vendorPrice>0&&v[w].vendorPrice<v[w].freeFreight&&t){if($("#popFreeFreight"+v[w].vendorId).hasClass("title-btn-disabled")){pingClick(cartUse,"MShopcart_NoneSelfFreightnoteAp","","","")}$("#popFreeFreight"+v[w].vendorId).removeClass("title-btn-disabled")}else{$("#popFreeFreight"+v[w].vendorId).addClass("title-btn-disabled")}var n=v[w].sorted;for(var u=0;u<n.length;u++){if(n[u].itemType==1){p=n[u].item;q=p.CheckType;$("#selected"+p.Id).val(q)}else{c=n[u].item;for(var d=0;d<c.Skus.length;d++){if(c.Stype==4){q=c.CheckType;$("$selected"+c.Skus[d].Id).val(q)}else{q=c.Skus[d].CheckType;$("#selected"+c.Skus[d].Id).val(q)}}}}var s="skuIds"+v[w].vendorId;var o=$("input[name="+s+"]");var y=$("input[name='skuIdSelected']");var m="suitIds"+v[w].vendorId;var B=$("input[name="+m+"]");var g=$("input[name='suitIdSelected']")}}}}}};function checkSelfCouponEntrance(g){var j,a,h,f,e,b;var c=document.querySelector("#shop-title-detail-JD");if(!isBlank(g.cart)&&!!g.cart.vendors){g=g.cart;j=g.vendors;if(!!j&&!!j.length){for(var d=0;d<j.length;d++){if(j[d].vendorId==8888){b=j[d].selfCouponsNum;a=document.querySelector("#freeFreight");h=a.className.indexOf("title-btn-disabled")!=-1;if(!b||parseInt(b)==0){if(!h){f=a.querySelector(".cart-new-btn.free-freight-btn .right-boundary");f.style.visibility="visible"}else{!c&&($("#freeFreight").append($('<span class="shop-title-8888" id="shop-title-detail-JD">'+$("#userGradeMessage").val()+"</span>")))}e=a.querySelector(".cart-new-btn.marginLt10");if(e){a.removeChild(e)}}else{if(h){$("#shop-title-detail-JD").remove()}}}}}}}function judgeLeastNumState(c){var e=document.querySelector("#subnum"+c);var f=document.querySelector("#num"+c);var b=document.querySelector("#atLeastNum"+c);var a=parseInt(f.value);if(!b){return}var d=parseInt(b.value);if(isNaN(d)||-1==d){return}if(a<=d){e.classList.add("limit-boundary")}else{e.classList.remove("limit-boundary")}}function setDefiniteNumById(w,c){var h=w.cart.vendors;var l;var e;var x;var u;var y=[];outerLoop:for(var t=0,r=h.length;t<r;t++){l=h[t].sorted;for(var s=0,v=l.length;s<v;s++){if(typeof l[s].itemType!="undefined"){if(l[s].itemType==1||l[s].itemType==4){e=l[s].item.Id;if(c==e){u=l[s].item.Num;b(e,u);if(l[s].itemType==1){y.length=0;y=y.concat(l[s].item.Gifts)}else{y.length=0;for(var p=0,d=l[s].item.Skus.length;p<d;p++){y=y.concat(l[s].item.Skus[p].Gifts)}}g(e,y);break outerLoop}}else{x=l[s].item.Skus;for(var q=0,a=x.length;q<a;q++){e=x[q].Id;if(c==e){u=x[q].Num;b(e,u);y.length=0;for(var o=0,f=x[q].Gifts.length;o<f;o++){y=y.concat(x[q].Gifts[o])}g(e,y);break outerLoop}}}}}}function b(j,m){var z=document.querySelector("#num"+c),i=document.querySelectorAll("#product"+j+" span.num-cont-show");if(typeof m!="undefined"){z.value=m}if(i&&i.length>0){for(var k=0,n=i.length;k<n;k++){i[k].innerHTML=m}}}function g(A,z){var m,C;m=document.querySelector("#product"+A);C=m.querySelectorAll("a.shp-cart-gift-list i.num-cont-show");if(!C||C.length==0){C=m.parentNode.querySelectorAll("a.shp-cart-gift-list i.num-cont-show")}if(z&&z.length>0){for(var B=0,i=z.length;B<i;B++){if(!C||C.length==0){var n='<div class="shp-cart-gift-list">';for(var j=0;j<z.length;j++){n+='<a href="javascript:beGiftDetail('+z[j].Id+');" class="shp-cart-gift-list">';n+="[\u8d60\u54c1]"+z[j].Name;if(z[j].stockState==""){n+='<i class="num-cont-show no-pro-color">'+z[j].stockState+"</i>"}else{n+='<i class="num-cont-show">'+z[j].Num+"</i>"}n+="</a>"}n+="</div>";$("#product"+A).append(n)}else{if(z[B].stockState=="\u65e0\u8d27"){C[B].innerHTML="\u65e0\u8d27";C[B].classList.add("no-pro-color")}else{C[B].innerHTML=z[B].Num;C[B].classList.remove("no-pro-color")}}}}else{if($("#product"+A).find(".shp-cart-gift-list").find(".num-cont-show").length>0){$("#product"+A).find(".shp-cart-gift-list").remove()}}}}function popMessage2(p){var h={callback:null};var f=$.extend(h,p);var d=f.description||"\u60a8\u786e\u5b9a\u7ee7\u7eed\u6267\u884c\u6b64\u64cd\u4f5c\u5417\uff1f";var i=f.cancelText||"\u53d6\u6d88";var g=f.saveText||"\u786e\u5b9a";var e=f.activity;var n=f.methodValue;var o="";o+='<div class="cart-pop-floor" id="'+e+'">';o+='<div class="cart-cover-floor"></div>';o+=' <div class="cart-info-box">';o+=' <div class="cart-info-box-content cart-bdb-1px">';o+=' <span class="cart-info-box-text">'+d+"</span>";o+=' </div><div class="cart-btn-box">';o+=' <a class="cart-btn-box-back" id="cancel">'+i+"</a>";o+=' <a  class="cart-btn-box-check" href="javascript:'+n+'" id="isok">'+g+"</a>";o+=" </div></div></div>";var k,c,a,j;var l={initModel:function(){$("body").append(o);c=$("#"+e);a=$("#cancel");j=$("#isok");k=$("body").height();var q=parseInt((document.documentElement.clientWidth)*0.15/2);var r=parseInt((document.documentElement.clientHeight-151)/2);$(".cart-info-box").css({marginLeft:q,marginTop:r})},show:function(){c.show()},hide:function(){c.show()}};var m=function(){l.initModel();c.show();b()};var b=function(){a.unbind("click");j.unbind("click");a.bind("click",function(){f.callback(false);c.hide();c.remove()});j.bind("click",function(){f.callback(true);c.hide();c.remove()})};return m()}var beGiftDetail=function(c){var b=$("#sid").val();var a="https://item.m.jd.com/product/"+c+".html?sid="+b;pingClick(cartUse,"MShopcartsale_Gift","","","");window.location.href=a};var beYBDetail=function(b){var c=$("#sid").val();var a="https://item.m.jd.com/product/"+b+".html?sid="+c;pingClick(cartUse,"MShopcartsale_SelectedInsurance","","","");window.location.href=a};var checkInterface=function(d){if(!!d&&!!d.cart){var e=d.cart;var c=e.resultCode;var b=$("#sid").val();if("0"!=c){var a="/cart/errorPage.action?sid="+b+"&resultCode="+c;window.location.href=a}}};function checkLimitNum(c){var b=c||event;var a=b.currentTarget;var d=a.className;if(d.indexOf("limit-boundary")!=-1){b.preventDefault();return false}}function checkLimitToast(e,d){var b=event;var a=b.currentTarget;var c=parseInt(a.value);if(c<e){$.toast({width:250,message:"\u5546\u54c1\u9650\u8d2d\uff0c\u6700\u5c11\u9700\u8981\u8d2d\u4e70"+e+"\u4ef6\u54e6\u007e",delay:2000,cls:"error-icon"});a.value=e}}var commonCheck=function(d){var a=$("#sid").val();if(typeof d!="undefined"&&typeof d.cart!="undefined"&&d&&d.cart){var g=d.cart;$("#normalSkus").val(g.normalSkus);$("#globalSkus").val(g.globalSkus);$("#otcSkus").val(g.otcSkus)}if(typeof d!="undefined"&&typeof d.cart!="undefined"&&d&&d.cart){try{var g=d.cart;var l=g.vendors;var k;var b;for(var f=0;f<l.length;f++){k=l[f].sorted;for(var c=0;c<k.length;c++){b=k[c];if(b.itemType!=1){if(typeof b.item.originId!="undefined"&&typeof b.item.Id!="undefined"&&b.item.originId!=b.item.Id){window.location.reload()}}}if(l[f].vendorId==8888){if(l[f].fareType!=undefined){$("#selfFareType").val(l[f].fareType)}}}if(g.couponParams!=undefined){$("#couponParams").val(g.couponParams)}couponInformExp();if(g.selfFreightInfo.selfFreightMsg!=undefined){$("#selfFreightMsg").val(g.selfFreightInfo.selfFreightMsg)}if(g.freshCheckedSkus!=undefined){$("#freshCheckedSkus").val(g.freshCheckedSkus)}if(g.normalCheckedSkus!=undefined){$("#normalCheckedSkus").val(g.normalCheckedSkus)}if(g.selfFreightPageMaiDian.freightNoteEventParam!=undefined){$("#FreightnoteEventParam").val(g.selfFreightPageMaiDian.freightNoteEventParam)}if(g.selfFreightPageMaiDian.freightNotePageParam!=undefined){$("#FreightnotePageParam").val(g.selfFreightPageMaiDian.freightNotePageParam)}}catch(h){}}};var beCartGiftDetail=function(c,b){if(c==undefined||c==""){return}if(b!=undefined){if(b>0){pingClick(cartUse,"MShopcart_TradeProduct",c,"","")}else{pingClick(cartUse,"MShopcart_PresentProduct",c,"","")}}var a="https://item.m.jd.com/product/"+c+".html";setTimeout(function(){window.location.href=a},100)};function attenMoveBtn(j,g,i,k,d,h,a,e){var c=$("#sid").val();var b="/cart/addFavorite.json?sid="+c+"&wareId="+i;try{pingClick(cartUse,"MShopcart_MoveToFollow","","","")}catch(f){}$.ajax({url:b,type:"POST",dataType:"json",success:function(m){if(m!=undefined&&m.isLogin!=undefined&&m.isLogin=="false"){try{pingClick(cartUse,"MShopcart_MoveToFollowUnlogin","","","")}catch(l){}toLogin()}else{if(m!=undefined&&m.addFavorite!=undefined&&m.addFavorite.flag!=undefined&&m.addFavorite.flag=="true"){$.toast({message:"\u5173\u6ce8\u6210\u529f",delay:2000,cls:"succee-icon"});if(e){operateDele(j,g,i,k)}else{operateDele(j,g,d,h,i,k,a)}}else{if(m!=undefined&&m.addFavorite!=undefined&&m.addFavorite.flag!=undefined&&m.addFavorite.flag=="false"){$.toast({message:m.addFavorite.addFavorite,delay:2000,cls:"error-icon"})}else{$.toast({message:"\u5173\u6ce8\u5931\u8d25",delay:2000,cls:"error-icon"})}}}},error:function(){$.toast({message:"\u5173\u6ce8\u5931\u8d25",delay:2000,cls:"error-icon"})}})}$(document).delegate(".atten-move-btn .btn-msg-in","click",function(){var k=$(this).parents(".shp-cart-item-core").siblings(".editPara").val();var d=JSON.parse(k);var h=d.shopId;var e=d.venderId;var c=d.suitId;var f=d.suitNum;var a=d.sType;var g=d.skuId;var i=d.skuNum;var j=d.ybId;var b=d.isPure;attenMoveBtn(h,e,g,i,c,f,a,b)});var toLogin=function(){var c=$("#returnurl").val();var a=$("#sid").val();var b="https://passport.m.jd.com/user/login.action?sid="+a+"&returnurl="+c;window.location.href=b};function setCookie(d,c,b,a){c=escape(c);if(b==""){return}if(a!=""){a=";Path="+a}document.cookie=d+"="+c+";expires="+b+a}function getCookieValue(d){var c=document.cookie;var b=c.indexOf(""+d+"=");var a=null;if(b==-1){b=c.indexOf(d+"=")}if(b==-1){c=null}else{b=c.indexOf("=",b)+1;a=c.indexOf(";",b);if(a==-1){a=c.length}c=unescape(c.substring(b,a))}return c}var skuLabelNum=0;var priceReId=$("#priceReduction");var priceIsClick=true;var priceReTxt=priceReId.find(".price-reduct-text").text();function pricePostTop(a){if(a){priceReId.css({position:"fixed",top:0,left:0,right:0,zIndex:1000});$("#priceReduction").addClass("check")}else{priceReId.css("position","static");priceReId.find(".price-reduct-text").text(priceReTxt);skuLabelNum=0;$("#priceReduction").removeClass("check")}}if(getCookieValue("priceReductCookie")=="false"){priceReId.remove()}else{priceReId.css({opacity:1,height:36+"px"})}priceReId.click(function(){var e=$("#isNeedMaodian").val();if(e==""||e==undefined||e==false||e=="false"){return}if(priceIsClick){var g=$("#noticeType").val();if(g=="1"||g==1){setTimeout(function(){pingClick(cartUse,"MShopcart_DepreciateLabel","","","")},0)}if(g=="2"||g==2){setTimeout(function(){pingClick(cartUse,"MShopcart_IousFree","","","")},0)}var f=$("#noticeNextMessage").val();var a=$("#skuLabelIdList").val();var b=a.split(",");var d=b.length;var h="";if($("#product"+b[skuLabelNum]+"").find('[name="item'+b[skuLabelNum]+'"]').length>0){h=$('[name="item'+b[skuLabelNum]+'"]')}else{h=$("#product"+b[skuLabelNum]+"")}if(skuLabelNum==0){var c=(h.offset().top)-36*2}else{var c=(h.offset().top)-36}$("body").animate({scrollTop:c},500,"swing",function(){if(skuLabelNum==d-1){priceIsClick=false;priceReId.fadeOut(800,function(){pricePostTop(false);priceReId.show();priceIsClick=true});skuLabelNum=0}else{skuLabelNum++}});setTimeout(function(){pricePostTop(true);var i="";if(f!=undefined&&f!=""){i=f}priceReId.find(".price-reduct-text").text(i)},100)}});$("#priceReduction").find(".price-reduct-dele").click(function(a){a.stopPropagation();priceReId.fadeOut(800,function(){$("#priceReduction").remove()});var b=new Date();b.setTime(b.getTime()+86400000);setCookie("priceReductCookie",false,b.toGMTString(),"");setTimeout(function(){pingClick(cartUse,"MShopcart_DepreciateClose","","","")},0)});function couponInformExp(){var a="/cart/checkFirstGanGetCoupon.json?sid="+$("#sid").val()+"&skuCouponParam="+$("#couponParams").val();$.ajax({url:a,type:"POST",dataType:"json",success:function(g){var d=g.couponDetail;var c=$("#imagesUrl").val();if(g.resultCode!=0){$("#informExpoCoup").remove();return false}else{if(getCookieValue("couponInformExp")==d.roleId){return false}else{if(g!=undefined&&g.resultCode==0){var f=$("#product"+d.skuId+"").parents(".shp-cart-list").siblings(".shop-title").find(".shop-btn-com");var b=f.find(".coupon-info-exp").attr("onclick");if($("#informExpoCoup").length>0){var i=$("#informExpoCoup");i.attr("data-rid",d.roleId);i.attr("onclick",b);i.find(".inform-expose-text").html(d.msg1+'<div class="inform-expose-coupdiv">'+d.msg2+"</div>"+d.msg3)}else{var h="";h+='<div class="coupon-inform-expose" id="informExpoCoup" data-rid="'+d.roleId+'"style="opacity:1" onclick="'+b+'">';h+='<span class="addAfter"><img src="'+c+'/images/cart5.0/defaultGoodsImage.png" class="inform-expose-img"/></span>';h+='<div class="inform-expose-text">'+d.msg1;h+='<div class="inform-expose-coupdiv">'+d.msg2+"</div>"+d.msg3;h+='</div><span class="inform-expose-icon"></span></div>';$("body").append(h)}pingClick(cartUse,"MShopcart_CouponShowUp","","","");var e=$("#product"+d.skuId+"").find(".cart-product-cell-1").find(".cart-photo-thumb");if(e.attr("_src")=="undefined"||e.attr("_src")==null||e.attr("_src")==""){setTimeout(function(){$("#informExpoCoup").find(".inform-expose-img").attr("src",e.attr("src"))},1000)}else{$("#informExpoCoup").find(".inform-expose-img").attr("src",e.attr("_src"))}}}}},error:function(){console.log("error")}})}couponInformExp();function operatingUrl(c,d,b){var a=c;if(d){pingClick(cartUse,"MShopcart_EmptyBanner",b,"","","3")}window.location.href=a};